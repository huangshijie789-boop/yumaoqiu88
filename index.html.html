<!-- 
    â˜… ç´§æ€¥æ±‚åŠ©ï¼šiPhone/å¾®ä¿¡ æ‰“ä¸å¼€æ€ä¹ˆåŠï¼Ÿ â˜…
    
    ã€ç°è±¡ã€‘
    å¦‚æœæ‚¨ç‚¹å¼€æ–‡ä»¶çœ‹åˆ°çš„æ˜¯ä¸€å †è‹±æ–‡ä»£ç ï¼Œè¯´æ˜æ‚¨çš„æ‰‹æœºæŠŠå®ƒå½“æˆäº†è®°äº‹æœ¬ã€‚
    
    ã€è§£å†³æ–¹æ³• Aï¼šæ”¹åå¤æ´»æ³•ï¼ˆæ¨èï¼‰ã€‘
    1. æ‰“å¼€æ‰‹æœºæ¡Œé¢ä¸Šè“è‰²çš„â€œæ–‡ä»¶â€APPã€‚
    2. æ‰¾åˆ°æ­¤æ–‡ä»¶ï¼Œã€é•¿æŒ‰ã€‘å®ƒ -> é€‰æ‹©ã€é‡å‘½åã€‘ã€‚
    3. æŠŠæ–‡ä»¶åæ”¹æˆï¼šè®¡ç®—å™¨.html (é‡ç‚¹æ˜¯åç¼€å¿…é¡»æ˜¯ .html)ã€‚
    4. ç³»ç»Ÿæç¤ºæ—¶ï¼Œé€‰æ‹©â€œä½¿ç”¨ .htmlâ€ã€‚
    5. å†ç‚¹å‡»æ–‡ä»¶ï¼Œå°±èƒ½å®Œç¾è¿è¡Œäº†ã€‚
    
    ã€è§£å†³æ–¹æ³• Bï¼šå‘é“¾æ¥ï¼ˆæœ€çœäº‹ï¼‰ã€‘
    å»ºè®®å‘é€è€…å°†æ­¤ä»£ç ç²˜è´´åˆ° jsrun.net æˆ– codepen.io ç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œ
    ç›´æ¥å‘é“¾æ¥ç»™æœ‹å‹ï¼Œæ— éœ€ä¸‹è½½ï¼Œä½“éªŒæœ€ä½³ã€‚
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ·±åœ³çŸ³å²©ç¾½æ¯›çƒé¦†æŠ•èµ„å›æŠ¥è®¡ç®—å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Helvetica Neue', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #f3f4f6;
        }
        /* ä¼˜åŒ–iOSå®‰å…¨åŒºåŸŸ */
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
        
        /* éšè—æ»šåŠ¨æ¡ä½†ä¿ç•™åŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* æ›´ç°ä»£çš„æ»‘å—æ ·å¼ */
        input[type=range] {
            -webkit-appearance: none; background: transparent; width: 100%;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%;
            background: #ffffff; border: 0.5px solid rgba(0,0,0,0.1);
            box-shadow: 0 2px 6px rgba(0,0,0,0.15); margin-top: -8px; 
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; background: #e5e7eb; border-radius: 2px;
        }
        
        /* ç‚¹å‡»åé¦ˆåŠ¨ç”» */
        .active-scale:active { transform: scale(0.95); }
    </style>
</head>
<body class="text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // å›¾æ ‡ç»„ä»¶
        const Icon = ({ d, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d={d} />
            </svg>
        );

        function App() {
            // --- çŠ¶æ€å®šä¹‰ ---
            const [numCourts, setNumCourts] = useState(6);
            const [rentPerSqm, setRentPerSqm] = useState(32); 
            const [courtSize, setCourtSize] = useState(150); 
            const [revenuePerCourt, setRevenuePerCourt] = useState(6300); 
            
            // åœ°æ¿é…ç½®
            const costKeelFloor = 130; 
            const costMatOnly = 50;    
            const [numKeelCourts, setNumKeelCourts] = useState(6); 
            
            // --- æ–°å¢ï¼šèƒ½è€—è¯¦ç»†é…ç½® (æ”¹ä¸ºç›´æ¥æ§åˆ¶æ—¥å‡åº¦æ•°) ---
            const [numAc, setNumAc] = useState(4); 
            const [numLights, setNumLights] = useState(36); 
            const [elecPrice, setElecPrice] = useState(1.5); 
            const [waterCost, setWaterCost] = useState(300); 
            
            // æ ¸å¿ƒçŠ¶æ€ï¼šå•å°æ—¥å‡è€—ç”µåº¦æ•°
            const [acDailyKwh, setAcDailyKwh] = useState(6); // é»˜è®¤éå¤å­£ï¼Œçº¦3kw*2h
            const [lightDailyKwh, setLightDailyKwh] = useState(1.2); // é»˜è®¤0.2kw*6h

            // è´¢åŠ¡æ¨¡å—TabçŠ¶æ€
            const [financeTab, setFinanceTab] = useState('overview');

            // è”åŠ¨é€»è¾‘ï¼šå½“åœºåœ°æ•°é‡å˜åŒ–æ—¶ï¼Œè‡ªåŠ¨è°ƒæ•´å»ºè®®çš„ç¯å…‰æ•°é‡ (6ç›/ç‰‡)
            useEffect(() => {
                setNumLights(numCourts * 6);
                setNumKeelCourts(Math.min(numKeelCourts, numCourts));
            }, [numCourts]);
            
            // è¿è¥é…ç½® (å¤å­£æ¨¡å¼è”åŠ¨)
            const [summerMode, setSummerMode] = useState(false); 

            // åˆ‡æ¢å¤å­£æ¨¡å¼æ—¶ï¼Œè‡ªåŠ¨è°ƒæ•´ç©ºè°ƒæ—¥å‡è€—ç”µé‡çš„å»ºè®®å€¼
            useEffect(() => {
                if (summerMode) {
                    setAcDailyKwh(24); // å¤å­£å»ºè®®ï¼š3kw * 8h = 24åº¦
                } else {
                    setAcDailyKwh(6);  // æ—¥å¸¸å»ºè®®ï¼š3kw * 2h = 6åº¦
                }
            }, [summerMode]);
            
            // äººå‘˜é…ç½®
            const [hasManager, setHasManager] = useState(true); 
            const [managerSalary, setManagerSalary] = useState(4000);
            const [hasCoach, setHasCoach] = useState(false); 
            const [coachSalary, setCoachSalary] = useState(10000);
            const [hasCleaner, setHasCleaner] = useState(false); 
            const [cleanerSalary, setCleanerSalary] = useState(3000);
            const [hasMarketing, setHasMarketing] = useState(false); 
            const [marketingCost, setMarketingCost] = useState(1500);

            // è‡ªå®šä¹‰è´¹ç”¨
            const [customExpenses, setCustomExpenses] = useState([]);
            const addExpense = () => {
                const newId = Date.now();
                // æ–°å¢ enabled: true å­—æ®µï¼Œé»˜è®¤å¯ç”¨
                setCustomExpenses([...customExpenses, { id: newId, name: 'æ‚é¡¹æ”¯å‡º', cost: 1000, enabled: true }]);
            };
            const updateExpense = (id, field, val) => {
                setCustomExpenses(customExpenses.map(c => c.id === id ? { ...c, [field]: val } : c));
            };
            const removeExpense = (id) => setCustomExpenses(customExpenses.filter(c => c.id !== id));

            // --- è®¡ç®—é€»è¾‘ ---
            const calculations = useMemo(() => {
                // 1. åœºåœ°ä¸è£…ä¿®æŠ•èµ„
                const totalArea = numCourts * courtSize;
                const actualKeel = Math.min(numKeelCourts, numCourts);
                const actualMat = numCourts - actualKeel;
                const investFloor = (actualKeel * courtSize * costKeelFloor) + (actualMat * courtSize * costMatOnly);
                
                // 2. ç¡¬ä»¶æŠ•èµ„
                const investHardware = (numAc * 4000) + (numLights * 500); 
                
                // 3. å…¶ä»–æ‚é¡¹æŠ•èµ„
                const otherInvest = (investHardware + investFloor) * 0.05;
                const totalInvest = investHardware + investFloor + otherInvest;

                // 4. æœˆå›ºå®šæ”¯å‡º
                const monthlyRent = totalArea * rentPerSqm;
                const monthlyStaff = (hasManager ? managerSalary : 0) + (hasCoach ? coachSalary : 0) + (hasCleaner ? cleanerSalary : 0);
                
                // 5. ç”µè´¹è¯¦ç»†è®¡ç®— (ç›´æ¥ç”¨æ—¥å‡åº¦æ•°ç®—)
                const monthlyAcKwh = numAc * acDailyKwh * 30;
                const monthlyAcElec = monthlyAcKwh * elecPrice;

                const monthlyLightKwh = numLights * lightDailyKwh * 30;
                const monthlyLightElec = monthlyLightKwh * elecPrice;

                const monthlyElec = monthlyAcElec + monthlyLightElec;
                const totalMonthlyKwh = monthlyAcKwh + monthlyLightKwh;
                
                // 6. å…¶ä»–æœˆæ”¯å‡º (åªè®¡ç®— enabled ä¸º true çš„æ‚é¡¹)
                const activeCustomExpenses = customExpenses.filter(c => c.enabled !== false).reduce((a,b)=>a+Number(b.cost),0);
                const monthlyOther = (hasMarketing ? marketingCost : 0) + 200 + waterCost + activeCustomExpenses; 
                
                const totalMonthlyCost = monthlyRent + monthlyStaff + monthlyElec + monthlyOther;
                const monthlyRevenue = numCourts * revenuePerCourt;
                const monthlyProfit = monthlyRevenue - totalMonthlyCost;
                const roiMonths = monthlyProfit > 0 ? totalInvest / monthlyProfit : 999;

                return { 
                    totalInvest, investFloor, investHardware, otherInvest,
                    totalMonthlyCost, monthlyProfit, monthlyRevenue, roiMonths, 
                    monthlyRent, monthlyStaff, monthlyElec, totalMonthlyKwh,
                    monthlyAcElec, monthlyLightElec, monthlyOther
                };
            }, [numCourts, rentPerSqm, courtSize, revenuePerCourt, numKeelCourts, summerMode, hasManager, managerSalary, hasCoach, coachSalary, hasCleaner, cleanerSalary, hasMarketing, marketingCost, customExpenses, numAc, acDailyKwh, numLights, lightDailyKwh, elecPrice, waterCost]);

            // --- åˆ†äº«åŠŸèƒ½ ---
            const handleShare = () => {
                const text = `ğŸ¸ ç¾½æ¯›çƒé¦†æŠ•èµ„å›æŠ¥åˆ†æ
----------------
ã€åœºåœ°è§„æ¨¡ã€‘${numCourts}ç‰‡
ã€æœˆæ€»æ”¯å‡ºã€‘${Math.floor(calculations.totalMonthlyCost)}å…ƒ
----------------
âš¡ï¸ ç”µè´¹é…ç½® (${summerMode ? 'å¤å­£' : 'æ—¥å¸¸'})
â€¢ ç”µä»·ï¼š${elecPrice}å…ƒ/åº¦
â€¢ ç©ºè°ƒè´¹ï¼š${Math.floor(calculations.monthlyAcElec)}å…ƒ/æœˆ
â€¢ ç¯å…‰è´¹ï¼š${Math.floor(calculations.monthlyLightElec)}å…ƒ/æœˆ
â€¢ æ€»ç”µè´¹ï¼š${Math.floor(calculations.monthlyElec)}å…ƒ/æœˆ
----------------
ğŸ“Š æœ€ç»ˆç»“æœ
${calculations.monthlyProfit > 0 ? 'âœ… ç›ˆåˆ©ä¸­' : 'âš ï¸ äºæŸä¸­'}
â€¢ é¢„ä¼°æœˆçº¯åˆ©ï¼š${Math.floor(calculations.monthlyProfit)}å…ƒ
â€¢ å›æœ¬å‘¨æœŸï¼š${calculations.roiMonths > 120 ? '>10å¹´' : Math.ceil(calculations.roiMonths) + 'ä¸ªæœˆ'}

(æ­¤æ•°æ®ç”±æŠ•èµ„å›æŠ¥è®¡ç®—å™¨ç”Ÿæˆ)`;
                
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    alert("âœ… åˆ†ææŠ¥å‘Šå·²å¤åˆ¶ï¼");
                } catch (err) {
                    alert("å¤åˆ¶å¤±è´¥ã€‚");
                }
                document.body.removeChild(textArea);
            };

            return (
                <div className="flex flex-col h-screen bg-slate-100">
                    
                    {/* é¡¶éƒ¨æ ‡é¢˜æ  */}
                    <div className="bg-white px-4 py-3 shadow-sm z-10 flex justify-between items-center shrink-0">
                        <div>
                            <h1 className="text-base font-bold text-slate-800">æŠ•èµ„å›æŠ¥è®¡ç®—å™¨</h1>
                        </div>
                        <div className="flex items-center gap-3">
                             <span className={`text-xs px-2 py-1 rounded-full font-medium ${calculations.monthlyProfit > 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`}>
                                {calculations.monthlyProfit > 0 ? 'ç›ˆåˆ©ä¸­' : 'äºæŸä¸­'}
                            </span>
                            <button onClick={handleShare} className="text-blue-600 active-scale p-1">
                                <Icon d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" className="w-5 h-5"/>
                            </button>
                        </div>
                    </div>

                    {/* å¯æ»šåŠ¨çš„ä¸»å†…å®¹åŒº */}
                    <div className="flex-1 overflow-y-auto no-scrollbar p-3 pb-32 space-y-3">
                        
                        {/* æ¨¡å—1: åŸºç¡€æ …æ ¼é…ç½® */}
                        <div className="bg-white rounded-xl p-3 shadow-sm">
                            <h2 className="text-xs font-bold text-slate-400 mb-3 uppercase tracking-wider">æ ¸å¿ƒå‚æ•°é…ç½®</h2>
                            <div className="grid grid-cols-2 gap-3 mb-4">
                                <div className="bg-slate-50 p-2.5 rounded-lg border border-slate-100">
                                    <div className="flex justify-between text-xs text-slate-500 mb-1">æ€»åœºåœ°</div>
                                    <div className="flex items-baseline gap-1 mb-2">
                                        <span className="text-xl font-bold text-blue-600">{numCourts}</span>
                                        <span className="text-xs">ç‰‡</span>
                                    </div>
                                    <input type="range" min="4" max="20" value={numCourts} onChange={e=>setNumCourts(Number(e.target.value))} className="accent-blue-600"/>
                                </div>
                                <div className="bg-slate-50 p-2.5 rounded-lg border border-slate-100">
                                    <div className="flex justify-between text-xs text-slate-500 mb-1">é¾™éª¨æ•°</div>
                                    <div className="flex items-baseline gap-1 mb-2">
                                        <span className="text-xl font-bold text-emerald-600">{Math.min(numKeelCourts, numCourts)}</span>
                                        <span className="text-xs">ç‰‡</span>
                                    </div>
                                    <input type="range" min="0" max={numCourts} value={Math.min(numKeelCourts, numCourts)} onChange={e=>setNumKeelCourts(Number(e.target.value))} className="accent-emerald-600"/>
                                </div>
                            </div>

                            <div className="grid grid-cols-3 gap-2">
                                <div className="bg-slate-50 p-2 rounded-lg border border-slate-100">
                                    <label className="text-[10px] text-slate-400 block mb-1">ç§Ÿé‡‘(å…ƒ/å¹³)</label>
                                    <input type="number" value={rentPerSqm} onChange={e=>setRentPerSqm(Number(e.target.value))} className="w-full bg-transparent font-bold text-slate-700 text-base outline-none p-0"/>
                                </div>
                                <div className="bg-slate-50 p-2 rounded-lg border border-slate-100">
                                    <label className="text-[10px] text-slate-400 block mb-1">å•ç‰‡è¥æ”¶</label>
                                    <input type="number" value={revenuePerCourt} onChange={e=>setRevenuePerCourt(Number(e.target.value))} className="w-full bg-transparent font-bold text-slate-700 text-base outline-none p-0"/>
                                </div>
                                <div className="bg-slate-50 p-2 rounded-lg border border-slate-100">
                                    <label className="text-[10px] text-slate-400 block mb-1">é¢ç§¯(å¹³)</label>
                                    <input type="number" value={courtSize} onChange={e=>setCourtSize(Number(e.target.value))} className="w-full bg-transparent font-bold text-slate-700 text-base outline-none p-0"/>
                                </div>
                            </div>
                        </div>

                        {/* æ¨¡å—2: èƒ½è€—ä¸æ°´ç”µé…ç½® (å‡çº§ç‰ˆ) */}
                        <div className="bg-white rounded-xl p-3 shadow-sm">
                            <h2 className="text-xs font-bold text-slate-400 mb-3 uppercase tracking-wider flex items-center gap-1">
                                <Icon d="M13 10V3L4 14h7v7l9-11h-7z" className="w-3 h-3" />
                                èƒ½è€—ä¸æ°´ç”µ
                            </h2>
                            
                            {/* å…¬å…±è´¹ç‡é…ç½®åŒº */}
                            <div className="grid grid-cols-2 gap-3 mb-4">
                                <div className="bg-blue-50/50 border border-blue-100 p-2 rounded-lg flex justify-between items-center">
                                    <label className="text-xs text-blue-800 shrink-0">ç”µè´¹å•ä»·</label>
                                    <div className="flex items-center flex-1 justify-end min-w-0">
                                        <input type="number" step="0.1" value={elecPrice} onChange={e=>setElecPrice(Number(e.target.value))} className="w-16 text-right bg-transparent font-bold text-blue-700 outline-none border-b border-blue-200 focus:border-blue-500 mr-1"/>
                                        <span className="text-[10px] text-blue-400 shrink-0">å…ƒ/åº¦</span>
                                    </div>
                                </div>
                                <div className="bg-slate-50 p-2 rounded-lg flex justify-between items-center">
                                    <label className="text-xs text-slate-500 shrink-0">æ°´è´¹é¢„ç®—</label>
                                    <div className="flex items-center flex-1 justify-end min-w-0">
                                        <input type="number" value={waterCost} onChange={e=>setWaterCost(Number(e.target.value))} className="w-16 text-right bg-transparent font-bold text-slate-700 outline-none mr-1"/>
                                        <span className="text-[10px] text-slate-400 shrink-0">å…ƒ</span>
                                    </div>
                                </div>
                            </div>
                            
                            {/* ç©ºè°ƒé…ç½® (ç›´æ¥åº¦æ•°) */}
                            <div className="mb-4 border-b border-slate-100 pb-3">
                                <div className="flex justify-between items-center mb-2">
                                    <div className="flex items-center gap-2">
                                        <span className="text-sm font-medium text-slate-700">ç©ºè°ƒç³»ç»Ÿ</span>
                                        <span className="text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded flex items-center">
                                            <input type="number" value={numAc} onChange={e=>setNumAc(Number(e.target.value))} className="w-10 bg-transparent text-center outline-none font-medium"/>å°
                                        </span>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-sm font-bold text-blue-600">
                                            Â¥{Math.floor(calculations.monthlyAcElec)}
                                            <span className="text-xs font-normal text-slate-400">/æœˆ</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="flex items-center gap-3">
                                    <div className="flex-1">
                                        <div className="flex justify-between text-[10px] text-slate-400 mb-1">
                                            <span>å•å°æ¯å¤©è€—ç”µ</span>
                                            <span className="text-blue-600 font-bold">{acDailyKwh}åº¦</span>
                                        </div>
                                        <input type="range" min="0" max="60" step="1" value={acDailyKwh} onChange={e=>setAcDailyKwh(Number(e.target.value))} className="accent-blue-500"/>
                                    </div>
                                    <div className="flex-1">
                                        <div className="flex justify-between text-[10px] text-slate-400 mb-1">
                                            <span>æ•°é‡è°ƒæ•´</span>
                                            <span>{numAc}å°</span>
                                        </div>
                                        <input type="range" min="0" max="20" value={numAc} onChange={e=>setNumAc(Number(e.target.value))} className="accent-blue-500"/>
                                    </div>
                                </div>
                            </div>

                            {/* ç¯å…‰é…ç½® (ç›´æ¥åº¦æ•°) */}
                            <div className="mb-2">
                                <div className="flex justify-between items-center mb-2">
                                    <div className="flex items-center gap-2">
                                        <span className="text-sm font-medium text-slate-700">ç¯å…‰ç…§æ˜</span>
                                        <span className="text-[10px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded flex items-center">
                                            <input type="number" value={numLights} onChange={e=>setNumLights(Number(e.target.value))} className="w-10 bg-transparent text-center outline-none font-medium"/>ç›
                                        </span>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-sm font-bold text-yellow-600">
                                            Â¥{Math.floor(calculations.monthlyLightElec)}
                                            <span className="text-xs font-normal text-slate-400">/æœˆ</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="flex items-center gap-3">
                                    <div className="flex-1">
                                        <div className="flex justify-between text-[10px] text-slate-400 mb-1">
                                            <span>å•ç›æ¯å¤©è€—ç”µ</span>
                                            <span className="text-yellow-600 font-bold">{lightDailyKwh}åº¦</span>
                                        </div>
                                        <input type="range" min="0" max="5" step="0.1" value={lightDailyKwh} onChange={e=>setLightDailyKwh(Number(e.target.value))} className="accent-yellow-500"/>
                                    </div>
                                    <div className="flex-1">
                                        <div className="flex justify-between text-[10px] text-slate-400 mb-1">
                                            <span>æ•°é‡è°ƒæ•´</span>
                                            <span>{numLights}ç›</span>
                                        </div>
                                        <input type="range" min="0" max="200" value={numLights} onChange={e=>setNumLights(Number(e.target.value))} className="accent-yellow-500"/>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* æ¨¡å—3: å¤å­£æ¨¡å¼å¡ç‰‡ */}
                        <div className={`rounded-xl p-3 shadow-sm border transition-all duration-300 flex items-center justify-between ${summerMode ? 'bg-orange-50 border-orange-200' : 'bg-white border-transparent'}`}>
                            <div className="flex items-center gap-3">
                                <div className={`p-2 rounded-full ${summerMode ? 'bg-orange-100 text-orange-500' : 'bg-slate-100 text-slate-400'}`}>
                                    <Icon className="w-5 h-5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                                </div>
                                <div>
                                    <div className={`text-sm font-bold ${summerMode ? 'text-orange-800' : 'text-slate-700'}`}>æ·±åœ³å¤å­£æ¨¡å¼</div>
                                    <div className="text-[10px] opacity-60">å¼€å¯åè‡ªåŠ¨å¢åŠ é¢„è®¾çš„ç©ºè°ƒè€—ç”µé‡</div>
                                </div>
                            </div>
                            <button onClick={() => setSummerMode(!summerMode)} className={`w-11 h-6 rounded-full relative transition-colors ${summerMode ? 'bg-orange-500' : 'bg-slate-300'}`}>
                                <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-transform shadow-sm ${summerMode ? 'translate-x-6' : 'translate-x-1'}`}></div>
                            </button>
                        </div>

                        {/* æ¨¡å—4: æ”¯å‡ºé…ç½® */}
                        <div className="bg-white rounded-xl p-3 shadow-sm">
                            <h2 className="text-xs font-bold text-slate-400 mb-3 uppercase tracking-wider">äººå‘˜ä¸æ‚é¡¹</h2>
                            <div className="grid grid-cols-1 gap-2">
                                {[
                                    {label: 'å…¨èŒé¦†ä¸»', on: hasManager, set: setHasManager, val: managerSalary, setVal: setManagerSalary, color: 'text-blue-600'},
                                    {label: 'é©»åœºæ•™ç»ƒ', on: hasCoach, set: setHasCoach, val: coachSalary, setVal: setCoachSalary, color: 'text-purple-600'},
                                    {label: 'ä¿æ´æ‚å·¥', on: hasCleaner, set: setHasCleaner, val: cleanerSalary, setVal: setCleanerSalary, color: 'text-cyan-600'},
                                    {label: 'ç¾å›¢æ¨å¹¿', on: hasMarketing, set: setHasMarketing, val: marketingCost, setVal: setMarketingCost, color: 'text-pink-600'},
                                ].map((item, i) => (
                                    <div key={i} className="flex justify-between items-center bg-slate-50 p-2.5 rounded-lg">
                                        <div className="flex items-center gap-2">
                                            <div 
                                                onClick={() => item.set(!item.on)}
                                                className={`w-5 h-5 rounded border flex items-center justify-center cursor-pointer ${item.on ? 'bg-blue-600 border-blue-600' : 'bg-white border-slate-300'}`}
                                            >
                                                {item.on && <Icon className="w-3.5 h-3.5 text-white" d="M5 13l4 4L19 7" />}
                                            </div>
                                            <span className={`text-sm font-medium ${item.on ? 'text-slate-700' : 'text-slate-400'}`}>{item.label}</span>
                                        </div>
                                        {item.on ? (
                                            <div className="flex items-center">
                                                <span className="text-xs text-slate-400 mr-1">Â¥</span>
                                                <input type="number" value={item.val} onChange={e=>item.setVal(Number(e.target.value))} className={`w-14 text-right bg-transparent font-bold text-sm outline-none ${item.color}`}/>
                                            </div>
                                        ) : <span className="text-xs text-slate-300">æœªå¯ç”¨</span>}
                                    </div>
                                ))}

                                {/* è‡ªå®šä¹‰è´¹ç”¨ (ä¼˜åŒ–ç‰ˆï¼šä¸ä¸Šæ–¹é£æ ¼ä¸€è‡´) */}
                                {customExpenses.map(exp => (
                                    <div key={exp.id} className="flex justify-between items-center bg-slate-50 p-2.5 rounded-lg transition-colors hover:bg-slate-100">
                                        <div className="flex items-center gap-2 flex-1 min-w-0">
                                            {/* å¤é€‰æ¡† (å¼€å…³) */}
                                            <div 
                                                onClick={() => updateExpense(exp.id, 'enabled', !exp.enabled)}
                                                className={`w-5 h-5 shrink-0 rounded border flex items-center justify-center cursor-pointer transition-colors ${exp.enabled ? 'bg-indigo-500 border-indigo-500' : 'bg-white border-slate-300'}`}
                                            >
                                                {exp.enabled && <Icon className="w-3.5 h-3.5 text-white" d="M5 13l4 4L19 7" />}
                                            </div>

                                            {/* åç§°è¾“å…¥ (æ— è¾¹æ¡†ï¼Œèå…¥èƒŒæ™¯) */}
                                            <div className="relative flex-1 min-w-0 flex items-center">
                                                <input 
                                                    type="text" 
                                                    value={exp.name} 
                                                    onChange={e=>updateExpense(exp.id, 'name', e.target.value)} 
                                                    className={`bg-transparent text-sm w-full outline-none transition-colors ${exp.enabled ? 'text-slate-700 font-medium' : 'text-slate-400 line-through'}`}
                                                />
                                            </div>
                                            
                                            {/* åˆ é™¤æŒ‰é’® (ç´§è·Ÿåç§°) */}
                                            <button 
                                                onClick={()=>removeExpense(exp.id)} 
                                                className="w-6 h-6 flex items-center justify-center text-slate-300 hover:text-red-500 active:scale-90 transition-all"
                                                title="åˆ é™¤æ­¤é¡¹"
                                            >
                                                <Icon d="M6 18L18 6M6 6l12 12" className="w-3 h-3"/>
                                            </button>
                                        </div>

                                        {/* é‡‘é¢è¾“å…¥ */}
                                        {exp.enabled ? (
                                            <div className="flex items-center shrink-0 ml-2">
                                                <span className="text-xs text-slate-400 mr-1">Â¥</span>
                                                <input 
                                                    type="number" 
                                                    value={exp.cost} 
                                                    onChange={e=>updateExpense(exp.id, 'cost', Number(e.target.value))} 
                                                    className="w-14 text-right bg-transparent font-bold text-sm outline-none text-indigo-600 border-b border-transparent focus:border-indigo-200 transition-colors"
                                                />
                                            </div>
                                        ) : (
                                            <span className="text-xs text-slate-300 shrink-0 ml-2">æœªå¯ç”¨</span>
                                        )}
                                    </div>
                                ))}
                                
                                <button onClick={addExpense} className="mt-1 w-full py-2.5 border border-dashed border-slate-300 text-slate-500 text-xs font-medium rounded-lg hover:bg-slate-50 hover:border-slate-400 active:bg-slate-100 transition-all flex items-center justify-center gap-1">
                                    <span className="text-lg leading-none">+</span> æ·»åŠ è‡ªå®šä¹‰æ”¯å‡º
                                </button>
                            </div>
                        </div>

                         {/* æ¨¡å—5: è´¢åŠ¡ä»ªè¡¨ç›˜ (æ”¯æŒTabåˆ‡æ¢) */}
                         <div className="bg-white rounded-xl p-3 shadow-sm mb-4">
                            <div className="flex justify-between items-center mb-3">
                                <h2 className="text-xs font-bold text-slate-400 uppercase tracking-wider">è´¢åŠ¡é€è§†</h2>
                                <div className="flex bg-slate-100 p-0.5 rounded-lg">
                                    <button 
                                        onClick={()=>setFinanceTab('overview')}
                                        className={`px-3 py-1 rounded-md text-[10px] font-medium transition-all ${financeTab==='overview' ? 'bg-white text-slate-700 shadow-sm' : 'text-slate-400'}`}
                                    >æ¦‚å†µ</button>
                                    <button 
                                        onClick={()=>setFinanceTab('detail')}
                                        className={`px-3 py-1 rounded-md text-[10px] font-medium transition-all ${financeTab==='detail' ? 'bg-white text-slate-700 shadow-sm' : 'text-slate-400'}`}
                                    >æ˜ç»†</button>
                                </div>
                            </div>
                            
                            {financeTab === 'overview' ? (
                                /* æ¦‚å†µè§†å›¾ */
                                <div className="grid grid-cols-2 gap-2">
                                    <div className="bg-slate-50 p-3 rounded-lg">
                                        <div className="text-[10px] text-slate-400 mb-1">æ€»å¯åŠ¨èµ„é‡‘</div>
                                        <div className="font-bold text-slate-700 text-sm">Â¥{Math.floor(calculations.totalInvest/10000)}<span className="text-xs">ä¸‡</span></div>
                                    </div>
                                    <div className="bg-slate-50 p-3 rounded-lg">
                                        <div className="text-[10px] text-slate-400 mb-1">æ¯æœˆæ€»å›ºå®šæ”¯å‡º</div>
                                        <div className="font-bold text-slate-700 text-sm">Â¥{Math.floor(calculations.totalMonthlyCost).toLocaleString()}</div>
                                    </div>
                                    <div className="bg-slate-50 p-3 rounded-lg">
                                        <div className="text-[10px] text-slate-400 mb-1">æœˆç§Ÿé‡‘æˆæœ¬</div>
                                        <div className="font-bold text-slate-700 text-sm">Â¥{Math.floor(calculations.monthlyRent).toLocaleString()}</div>
                                    </div>
                                    <div className="bg-orange-50 p-3 rounded-lg border border-orange-100">
                                        <div className="text-[10px] text-orange-400 mb-1">é¢„è®¡ç”µè´¹</div>
                                        <div className="font-bold text-orange-600 text-sm">Â¥{Math.floor(calculations.monthlyElec).toLocaleString()}</div>
                                        <div className="text-[10px] text-orange-400/60 mt-0.5">{Math.floor(calculations.totalMonthlyKwh)}åº¦</div>
                                    </div>
                                </div>
                            ) : (
                                /* æ˜ç»†è§†å›¾ */
                                <div className="space-y-3">
                                    {/* æœˆåº¦æ”¶æ”¯è¡¨ */}
                                    <div>
                                        <div className="text-[10px] text-slate-400 mb-2 font-bold pl-1">æœˆåº¦æ”¶æ”¯è¡¨</div>
                                        <div className="bg-slate-50 rounded-lg p-3 space-y-2 text-xs">
                                            <div className="flex justify-between items-center">
                                                <span className="text-slate-500">é¢„ä¼°è¥æ”¶</span>
                                                <span className="font-bold text-slate-700">+{Math.floor(calculations.monthlyRevenue)}</span>
                                            </div>
                                            <div className="h-px bg-slate-200 my-1"></div>
                                            <div className="flex justify-between items-center text-slate-500">
                                                <span>åœºåœ°ç§Ÿé‡‘</span>
                                                <span>-{Math.floor(calculations.monthlyRent)}</span>
                                            </div>
                                            <div className="flex justify-between items-center text-slate-500">
                                                <span>äººå·¥è–ªèµ„</span>
                                                <span>-{Math.floor(calculations.monthlyStaff)}</span>
                                            </div>
                                            <div className="flex justify-between items-center text-slate-500">
                                                <span>ç”µè´¹æ”¯å‡º</span>
                                                <span>-{Math.floor(calculations.monthlyElec)}</span>
                                            </div>
                                             <div className="flex justify-between items-center text-slate-500">
                                                <span>å…¶ä»–æ‚é¡¹</span>
                                                <span>-{Math.floor(calculations.monthlyOther)}</span>
                                            </div>
                                            <div className="h-px bg-slate-200 my-1"></div>
                                            <div className="flex justify-between items-center font-bold">
                                                <span className="text-slate-700">æœˆçº¯åˆ©æ¶¦</span>
                                                <span className={calculations.monthlyProfit > 0 ? 'text-red-500' : 'text-green-600'}>
                                                    {calculations.monthlyProfit > 0 ? '+' : ''}{Math.floor(calculations.monthlyProfit)}
                                                </span>
                                            </div>
                                        </div>
                                    </div>

                                    {/* æŠ•èµ„æ„æˆè¡¨ */}
                                    <div>
                                        <div className="text-[10px] text-slate-400 mb-2 font-bold pl-1">æŠ•èµ„æ„æˆè¡¨</div>
                                        <div className="bg-slate-50 rounded-lg p-3 space-y-2 text-xs">
                                            <div className="flex justify-between items-center text-slate-500">
                                                <span>ç¡¬ä»¶è®¾æ–½ (ç©ºè°ƒ/ç¯)</span>
                                                <span>{Math.floor(calculations.investHardware)}</span>
                                            </div>
                                            <div className="flex justify-between items-center text-slate-500">
                                                <span>åœ°é¢å·¥ç¨‹ (é¾™éª¨/èƒ¶)</span>
                                                <span>{Math.floor(calculations.investFloor)}</span>
                                            </div>
                                            <div className="flex justify-between items-center text-slate-500">
                                                <span>å…¶ä»–æ‚é¡¹ (é¢„ä¼°5%)</span>
                                                <span>{Math.floor(calculations.otherInvest)}</span>
                                            </div>
                                             <div className="h-px bg-slate-200 my-1"></div>
                                            <div className="flex justify-between items-center font-bold">
                                                <span className="text-slate-700">æ€»æŠ•èµ„é¢</span>
                                                <span>{Math.floor(calculations.totalInvest)}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* åº•éƒ¨å›ºå®šæ€»æ§å° */}
                    <div className="bg-white border-t border-slate-200 p-4 safe-bottom fixed bottom-0 w-full shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] z-50">
                        <div className="flex items-center justify-between">
                            <div className="flex flex-col">
                                <span className="text-xs text-slate-400 mb-0.5">é¢„ä¼°æœˆçº¯åˆ©</span>
                                <div className={`text-2xl font-bold leading-none ${calculations.monthlyProfit > 0 ? 'text-red-600' : 'text-green-600'}`}>
                                    <span className="text-sm align-top mr-0.5">Â¥</span>
                                    {Math.floor(calculations.monthlyProfit).toLocaleString()}
                                </div>
                            </div>
                            
                            <div className="h-8 w-px bg-slate-200 mx-4"></div>

                            <div className="flex flex-col items-end min-w-[80px]">
                                <span className="text-xs text-slate-400 mb-0.5">å›æœ¬å‘¨æœŸ</span>
                                <div className="text-xl font-bold text-slate-800 leading-none flex items-baseline">
                                    {calculations.roiMonths > 120 ? '>10' : Math.ceil(calculations.roiMonths)}
                                    <span className="text-xs font-normal text-slate-500 ml-1">ä¸ªæœˆ</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>